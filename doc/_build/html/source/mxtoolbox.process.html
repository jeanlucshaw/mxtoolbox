
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>process subpackage &#8212; mxtoolbox April 2020 documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="read subpackage" href="mxtoolbox.read.html" />
    <link rel="prev" title="plot subpackage" href="mxtoolbox.plot.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mxtoolbox.read.html" title="read subpackage"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mxtoolbox.plot.html" title="plot subpackage"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">mxtoolbox April 2020 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="process-subpackage">
<h1>process subpackage<a class="headerlink" href="#process-subpackage" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-mxtoolbox.process.analyses">
<span id="analyses-module"></span><h2>analyses module<a class="headerlink" href="#module-mxtoolbox.process.analyses" title="Permalink to this headline">¶</a></h2>
<p>Complex analyses transforming data into other data.</p>
<dl class="function">
<dt id="mxtoolbox.process.analyses.pca">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">pca</code><span class="sig-paren">(</span><em class="sig-param">input_</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.pca" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform principal component analysis on numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_</strong> (<em>2D array</em>) – Columns (n) are variables, rows (m) are observations.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>U</strong> (<em>2D array (n by n)</em>) – Columns are the eigenvectors.</p></li>
<li><p><strong>lbda</strong> (<em>1D array</em>) – Eigenvalues.</p></li>
<li><p><strong>F</strong> (<em>2D array</em>) – Matrix of component scores.</p></li>
<li><p><strong>UL_sr</strong> (<em>2D array</em>) – Projection of the descriptors to PC space.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Implemented following,</p>
<p>Legendre and Legendre (1998), Numerical Ecology, Elsevier, 852 pp.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.analyses.pd_pca">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">pd_pca</code><span class="sig-paren">(</span><em class="sig-param">dataframe</em>, <em class="sig-param">features</em>, <em class="sig-param">target=None</em>, <em class="sig-param">plot=False</em>, <em class="sig-param">**plt_kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.pd_pca" title="Permalink to this definition">¶</a></dt>
<dd><p>Add principal component vectors to dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>pandas.DataFrame</em>) – Data to analyse.</p></li>
<li><p><strong>features</strong> (<em>list of str</em>) – Descriptors to use.</p></li>
<li><p><strong>target</strong> (<em>str</em>) – Name of target column.</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – Visualize results.</p></li>
<li><p><strong>plt_kwargs</strong> (<em>dict</em>) – Keyword arguments passed to pandas.plot.scatter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>pcdf</strong> (<em>pandas.Dataframe</em>) – Input dataframe with added PC columns.</p></li>
<li><p><strong>lbda</strong> (<em>1D array</em>) – Eigenvalues of principal modes.</p></li>
<li><p><strong>UL_sr</strong> (<em>2D array</em>) – Projection of features to reduced space.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.analyses.principal_modes">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">principal_modes</code><span class="sig-paren">(</span><em class="sig-param">args</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.principal_modes" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform eigenvalue decomposition using numpy.</p>
<p>Given a dataset described by <cite>n</cite> vectors of length
<cite>m</cite>, the principal modes of variation can be extracted
using eigenvalue decomposition. The <cite>n</cite> vectors are
first detrended by subtracting the mean. A covariance
matrix <cite>R</cite> is then calculated as,</p>
<div class="math notranslate nohighlight">
\[\mathbf{R} = \mathbf{F}\cdot\mathbf{F'}\]</div>
<p>where <span class="math notranslate nohighlight">\(F\)</span> is a matrix whose columns are formed from
the <cite>n</cite> detrended input vectors. This matrix is then
passed to <cite>numpy.linalg.eig</cite> whose outputs <cite>w</cite> and <cite>v</cite>
are returned.</p>
<p>In addition, the matrix <span class="math notranslate nohighlight">\(\mathbf{v}\)</span> is
inverted and returned as <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> to provide
a basis change matrix into principal mode space. The
orginal coordinates may then be rotated into principal
mode space by arranging them into the <cite>n</cite> by <cite>m</cite> matrix
<span class="math notranslate nohighlight">\(O\)</span> by multiplication,</p>
<div class="math notranslate nohighlight">
\[\mathbf{C} = \mathbf{B}\cdot\mathbf{O}\]</div>
<p>we get the matrix <cite>n</cite> by <cite>m</cite> matrix <span class="math notranslate nohighlight">\(c\)</span> whose rows
are the rotated vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<em>tuple</em>) – Vectors of length m.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>vals</strong> (<em>array (n)</em>) – Eigenvalues of the covariance matrix.</p></li>
<li><p><strong>vecs</strong> (<em>ndarray (n by n)</em>) – Eigenvectors (columns).</p></li>
<li><p><strong>B</strong> (<em>ndarray (n by n)</em>) – Basis change matrix.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.analyses.gaussian_smoothing">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">gaussian_smoothing</code><span class="sig-paren">(</span><em class="sig-param">xs</em>, <em class="sig-param">ys</em>, <em class="sig-param">zs</em>, <em class="sig-param">xg</em>, <em class="sig-param">yg</em>, <em class="sig-param">XR=1.0</em>, <em class="sig-param">YR=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.gaussian_smoothing" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates scattered data to grid via Gaussian smoothing.</p>
<p>Simplified version of the Barnes smoothing algorithm. This
routine computes a value for each grid point by averaging
all scattered data are weighted by their distance to the grid
point. The weighing function for scatter point <cite>i</cite> is,</p>
<div class="math notranslate nohighlight">
\[w_i = \text{exp}\left[-\left(\frac{xg-xs_i}{XR}\right)^2 +
                 \left(\frac{yg-ys_i}{YR}\right)^2\right]\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xs, ys</strong> (<em>1D array</em>) – Coordinates of the scattered data.</p></li>
<li><p><strong>zs</strong> (<em>1D array</em>) – Values of the scattered data.</p></li>
<li><p><strong>xg, yg</strong> (<em>2D array</em>) – Grid coordinates.</p></li>
<li><p><strong>XR, YR</strong> (<em>float</em>) – Horizontal and vertical search radius.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>zg</strong> – Scattered data interpolated to grid.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.analyses.lsq_curve_fit">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">lsq_curve_fit</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">*parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.lsq_curve_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Least squares fitting using scipy.optimize.</p>
<p>Formatting input for scipy.optimize.leastsq can
be confusing. This wrapper serves the purpose of
not having to remember how it works.</p>
<p>Let <span class="math notranslate nohighlight">\(y=f(x)\)</span> and <cite>g</cite> be a model for <cite>f</cite>
dependent on a variable number of parameters
<span class="math notranslate nohighlight">\(\mathbf{a}\)</span>. Then this routine requires
requires <cite>model</cite> to be a function object taking
as arguments <cite>x</cite>, <span class="math notranslate nohighlight">\(a_1, a_2, ..., a_n\)</span> in this
order, and <cite>*parameters</cite> to be ordered initial guesses
for <span class="math notranslate nohighlight">\(\mathbf{a}\)</span>.</p>
<p>The following predefined models can serve as examples
and can be called by setting <cite>model</cite> to the function
name.</p>
<ul class="simple">
<li><p>mxtoolbox.process.math.f_gaussian</p></li>
<li><p>mxtoolbox.process.math.f_sine</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>function object or str</em>) – Must be of form <cite>y = model(x, a_1, a_2, …)</cite></p></li>
<li><p><strong>x, y</strong> (<em>1D array</em>) – Dependent and independent variables.</p></li>
<li><p><strong>parameters</strong> (<em>tuple of floats</em>) – Ordered initial guesses for <span class="math notranslate nohighlight">\(\mathbf{a}\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fit_values</strong> (<em>1D array</em>) – model(<cite>x</cite>, a_1, a_2, …) using optimized parameters.</p></li>
<li><p><strong>fit_parameters</strong> (<em>1D array</em>) – Optimized model parameters.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.analyses.pd_regression_statistics">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">pd_regression_statistics</code><span class="sig-paren">(</span><em class="sig-param">dataframe</em>, <em class="sig-param">xname</em>, <em class="sig-param">yname</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.pd_regression_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Print analysis of variance on linear regression.</p>
<p>Print analysis of variance (ANOVA) table for a linear regression
drawn for yname from xname, two columns of dataframe. The independent
variable is considered to be xname.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>pandas.Dataframe</em>) – The dataframe to operate on.</p></li>
<li><p><strong>xname</strong> (<em>str</em>) – Column name of the independent variable.</p></li>
<li><p><strong>yname</strong> (<em>str</em>) – Column name of the dependent variable.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>Van Emden, Helmut (2008)
Statistics for terrified biologists,
Blackwell publishing
p. 262</p>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.analyses.xr_2D_to_1D_interp">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">xr_2D_to_1D_interp</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">xcoord</em>, <em class="sig-param">ycoord</em>, <em class="sig-param">name</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.xr_2D_to_1D_interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate 2D field along arbitrary track.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>xarray.Dataset or xarray.DataArray</em>) – Data from which to interpolate.</p></li>
<li><p><strong>x, y</strong> (<em>1D array</em>) – Coordinates of interpolation track.</p></li>
<li><p><strong>xcoord, ycoord</strong> (<em>str</em>) – Coordinate names of the 2D field.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – Name of the track coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Field interpolated to track.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xarray.Dataset or xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.analyses.xr_cross_correlate">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">xr_cross_correlate</code><span class="sig-paren">(</span><em class="sig-param">dataarray_a</em>, <em class="sig-param">dataarray_b</em>, <em class="sig-param">coord='time'</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.xr_cross_correlate" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute cross correlation between DataArrays dataarray_a and dataarray_b.</p>
<p>The two input arrays can contain NaN values and be of different
lengths but they must have the same coordinate resolution
and coordinates must match on overlap. Resample prior to
using if necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataarray_a, dataarray_b</strong> (<em>xarray.DataArray</em>) – Arrays to correlate.</p></li>
<li><p><strong>coord</strong> (<em>str</em>) – Name of dimension along which to operate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>tau</strong> (<em>float</em>) – dataarray_a shifted forward by <cite>tau</cite> matches dataarray_b</p></li>
<li><p><strong>r2</strong> (<em>float</em>) – Variance explained at maximum cross correlation.</p></li>
<li><p><strong>dataarray_c</strong> (<em>xarray.DataArray</em>) – dataarray_b shifted to maximum correlation.</p></li>
<li><p><strong>cc</strong> (<em>1D array</em>) – Cross correlation vector.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.analyses.xr_time_aht">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">xr_time_aht</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">field='h'</em>, <em class="sig-param">period=12.4166</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.xr_time_aht" title="Permalink to this definition">¶</a></dt>
<dd><p>Add time after high tide variable to dataset.</p>
<p>The cleaner the input time series, the cleaner the
ouptut values will be. Before using consider,</p>
<blockquote>
<div><ul class="simple">
<li><p>Sorting by times.</p></li>
<li><p>Removing duplicate times.</p></li>
<li><p>Replacing missing values with harmonic analysis.</p></li>
<li><p>Interpolating to regular time.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>xarray.Dataset</em>) – Data structure to operate on.</p></li>
<li><p><strong>field</strong> (<em>str</em>) – Name of sea level variable.</p></li>
<li><p><strong>period</strong> (<em>float</em>) – Number of hours in one tidal cycle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>xarray.Dataset</em> – Data structure with the added <cite>aht</cite> variable (h).</p></li>
<li><p><em>1D array</em> – Index values of high tides in input time array.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-mxtoolbox.process.convert">
<span id="convert-module"></span><h2>convert module<a class="headerlink" href="#module-mxtoolbox.process.convert" title="Permalink to this headline">¶</a></h2>
<p>Simple data conversions. Includes unit conversions and thermodynamic property
conversions.</p>
<dl class="function">
<dt id="mxtoolbox.process.convert.anomaly2rgb">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">anomaly2rgb</code><span class="sig-paren">(</span><em class="sig-param">values</em>, <em class="sig-param">normal=0.5</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.anomaly2rgb" title="Permalink to this definition">¶</a></dt>
<dd><p>Map standardized anomaly to discretized red to blue color scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<em>float or 1D array</em>) – Standardized anomaly value.</p></li>
<li><p><strong>normal</strong> (<em>float</em>) – Defines the absolute range of anomalies for which to return
a white RGB triplet.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RGB triplet.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.binc2edge">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">binc2edge</code><span class="sig-paren">(</span><em class="sig-param">z</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.binc2edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Get bin edges from bin centers.</p>
<p>Bin centers can be irregularly spaced. Edges are halfway between
one point and the next.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>numpy.array, pandas.DatetimeIndex, pandas.Series</em>) – Bin centers.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Bin edges.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array, pandas.DatetimeIndex, pandas.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.bine2center">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">bine2center</code><span class="sig-paren">(</span><em class="sig-param">bine</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.bine2center" title="Permalink to this definition">¶</a></dt>
<dd><p>Get bin centers from bin edges.</p>
<p>Bin centers can be irregularly spaced. Edges are halfway between
one point and the next.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bine</strong> (<em>1D array</em>) – Bin edges.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Bin centers.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.dd2dms">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">dd2dms</code><span class="sig-paren">(</span><em class="sig-param">degrees_decimal</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.dd2dms" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert coordinates from decimal degrees to deg., min., sec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>degrees_decimal</strong> (<em>float or 1D array</em>) – Coordinates in decimal degrees, positive east.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>degrees</strong> (<em>float or 1D array</em>) – Degree of coordinate, positive east.</p></li>
<li><p><strong>minutes</strong> (<em>float or 1D array</em>) – Minutes of coordinate, positive definite.</p></li>
<li><p><strong>seconds</strong> (<em>float or 1D array</em>) – Seconds of coordinate, positive definite.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.dms2dd">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">dms2dd</code><span class="sig-paren">(</span><em class="sig-param">degrees</em>, <em class="sig-param">minutes</em>, <em class="sig-param">seconds</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.dms2dd" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert coordinates from deg., min., sec., to decimal degress.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>degrees</strong> (<em>float or 1D array</em>) – Degree of coordinate, positive east.</p></li>
<li><p><strong>minutes</strong> (<em>float or 1D array</em>) – Minutes of coordinate, positive definite.</p></li>
<li><p><strong>seconds</strong> (<em>float or 1D array</em>) – Seconds of coordinate, positive definite.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Coordinates in decimal degrees.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or 1D array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.degrees_180_to_360">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">degrees_180_to_360</code><span class="sig-paren">(</span><em class="sig-param">angles</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.degrees_180_to_360" title="Permalink to this definition">¶</a></dt>
<dd><p>Change degree range: (-180, 180) -&gt; (0, 360)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>angles</strong> (<em>1D array</em>) – The angles to convert.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Converted angles.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.degrees_360_to_180">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">degrees_360_to_180</code><span class="sig-paren">(</span><em class="sig-param">angles</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.degrees_360_to_180" title="Permalink to this definition">¶</a></dt>
<dd><p>Change degree range: (0, 360) -&gt; (-180, 180)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>angles</strong> (<em>1D array</em>) – The angles to convert.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Converted angles.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.dt2epoch">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">dt2epoch</code><span class="sig-paren">(</span><em class="sig-param">datetimes</em>, <em class="sig-param">div=1</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.dt2epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert datetime array to numeric (epoch).</p>
<p>The output units are defined by the div parameter. For
reference,</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">div=1</span></code> means seconds.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">div=60</span></code> means minutes.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">div=3600</span></code> means hours.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">div=86400</span></code> means days.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datetimes</strong> (<em>1D array of datetime64</em>) – Times to convert.</p></li>
<li><p><strong>div</strong> (<em>float</em>) – Divide times by this value to set unit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Time in numeric values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.hd2uv">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">hd2uv</code><span class="sig-paren">(</span><em class="sig-param">heading</em>, <em class="sig-param">magnitude</em>, <em class="sig-param">rotate_by=0</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.hd2uv" title="Permalink to this definition">¶</a></dt>
<dd><p>Return u, v vector components from heading and magnitude.</p>
<p><cite>heading</cite> is assumed to start from North at 0 and rotate clockwise (90 at
East). The components can be returned in a frame of reference rotated
clockwise by setting <cite>rotate_by</cite> in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>heading</strong> (<em>array_like</em>) – Compass direction (degrees).</p></li>
<li><p><strong>magnitude</strong> (<em>array_like</em>) – Vector norm.</p></li>
<li><p><strong>rotate_by</strong> (<em>float</em>) – Theta direction of returned <cite>u</cite> component.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>u, v</strong> – Vector components in chosen frame of reference.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.lonlat2distances">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">lonlat2distances</code><span class="sig-paren">(</span><em class="sig-param">lon</em>, <em class="sig-param">lat</em>, <em class="sig-param">meters_per_unit=1</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.lonlat2distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Get distance between points of a GPS track.</p>
<p>Distances are returned in meters by default. This
can be adjusted by setting the <cite>meters_per_unit</cite>
parameter (e.g. 1000 for km).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon, lat</strong> (<em>1D array</em>) – Plate carree coordinates to process.</p></li>
<li><p><strong>meters_per_unit</strong> (<em>float</em>) – Number of meters in the desired output unit of distance.</p></li>
<li><p><strong>kwargs</strong> (<em>keyword arguments</em>) – Passed to <cite>pyroj.Geod</cite> .</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>distances</strong> – Separating the input coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.lonlat2distancefrom">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">lonlat2distancefrom</code><span class="sig-paren">(</span><em class="sig-param">lon</em>, <em class="sig-param">lat</em>, <em class="sig-param">lon_0</em>, <em class="sig-param">lat_0</em>, <em class="sig-param">meters_per_unit=1</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.lonlat2distancefrom" title="Permalink to this definition">¶</a></dt>
<dd><p>Get distance between GPS track and a fixed coordinate.</p>
<p>Distances are returned in meters by default. This
can be adjusted by setting the <cite>meters_per_unit</cite>
parameter (e.g. 1000 for km).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon, lat</strong> (<em>1D array</em>) – Plate carree coordinates of GPS track.</p></li>
<li><p><strong>lon_0, lat_0</strong> (<em>1D array</em>) – Plate carree coordinates of fixed coordinate.</p></li>
<li><p><strong>meters_per_unit</strong> (<em>float</em>) – Number of meters in the desired output unit of distance.</p></li>
<li><p><strong>kwargs</strong> (<em>keyword arguments</em>) – Passed to <cite>pyroj.Geod</cite> .</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>distances</strong> – Separating the input coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.lonlat2heading">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">lonlat2heading</code><span class="sig-paren">(</span><em class="sig-param">lon</em>, <em class="sig-param">lat</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.lonlat2heading" title="Permalink to this definition">¶</a></dt>
<dd><p>Get forward azimuth from GPS track.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon, lat</strong> (<em>1D array</em>) – Plate carree coordinates to process.</p></li>
<li><p><strong>kwargs</strong> (<em>keyword arguments</em>) – Passed to <cite>pyroj.Geod</cite> .</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>heading</strong> – Forward azimuth.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.lonlat2speed">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">lonlat2speed</code><span class="sig-paren">(</span><em class="sig-param">lon</em>, <em class="sig-param">lat</em>, <em class="sig-param">time</em>, <em class="sig-param">heading=None</em>, <em class="sig-param">top_speed=None</em>, <em class="sig-param">meters_per_unit=1</em>, <em class="sig-param">seconds_per_unit=1</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.lonlat2speed" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert GPS track u, v and speed.</p>
<p>Speeds are returned in meters per second by default, but
this can be adjusted using the <cite>meters_per_unit</cite> and
<cite>seconds_per_unit</cite> optional paramters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon, lat</strong> (<em>1D array</em>) – Plate carree coordinates to process.</p></li>
<li><p><strong>time</strong> (<em>1D array of np.datetime64</em>) – Must convertible to <cite>datetime64[s]</cite>.</p></li>
<li><p><strong>heading</strong> (<em>1D array</em>) – Forward azimuth vector. Calculated if not specified.</p></li>
<li><p><strong>top_speed</strong> (<em>float</em>) – Filter out speeds greater than this value.</p></li>
<li><p><strong>meters_per_unit</strong> (<em>float</em>) – Number of meters in the desired output unit of distance.</p></li>
<li><p><strong>seconds_per_unit</strong> (<em>float</em>) – Number of seconds in the desired output unit of time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>u, v</strong> (<em>1D array</em>) – Eastward and northward velocity components.</p></li>
<li><p><strong>speed</strong> (<em>1D array</em>) – Magnitude of velocity.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.pd_add_seasons">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">pd_add_seasons</code><span class="sig-paren">(</span><em class="sig-param">dataframe</em>, <em class="sig-param">time='time'</em>, <em class="sig-param">stype='astro'</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.pd_add_seasons" title="Permalink to this definition">¶</a></dt>
<dd><p>Add season column to a dataframe containing a datetime column. The name
of the datetime column can be specified in parameter time. Astronimical
or meteorological seasons can be returned by specifiying ‘astro’ or
or ‘met’ at the stype parameter. Astronomical seasons are taken to start
on the 20th (near the solstice and equinoxes) and meteorological seasons
are given starting one the 1st of the months containing the solstices and
equinoxes.</p>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.theta2hd">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">theta2hd</code><span class="sig-paren">(</span><em class="sig-param">theta</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.theta2hd" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert angles: (E=0, N=90) to (E=90, N=0).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>theta</strong> (<em>1D array</em>) – Angle in x,y reference frame.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Angle as read on compass.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.uv2hd">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">uv2hd</code><span class="sig-paren">(</span><em class="sig-param">u</em>, <em class="sig-param">v</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.uv2hd" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert 2D cartesian (u, v) vectors to polar (r, bearing).</p>
<p>The returned polar coordinates are distance from 0 and
angle in degrees with 0 at north and 90 at east.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>u, v</strong> (<em>1D arrays</em>) – Data in cartesian form.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>r, bearing</strong> – Data in polar form.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.xr_SA_CT_pden">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">xr_SA_CT_pden</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">t='temperature'</em>, <em class="sig-param">s='salinity'</em>, <em class="sig-param">p='z'</em>, <em class="sig-param">lon='longitude'</em>, <em class="sig-param">lat='latitude'</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.xr_SA_CT_pden" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an xarray dataset width added CT, SA and sigma0
columns as calculated by the Gibbs Seawater package gsw.</p>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.dayofyear2dt">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">dayofyear2dt</code><span class="sig-paren">(</span><em class="sig-param">days</em>, <em class="sig-param">yearbase</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.dayofyear2dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Function yb2dt() syntax:        out     = yb2dt(input,yearbase)</p>
<p>Takes as input days since january first of the year specified by yearbase and
returns a list of datetime objects.</p>
<p>Convert UTC days of year since January 1, 00:00:00 of <cite>yearbase</cite> to datetime array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>days</strong> (<em>1D array</em>) – Dates in day of year format.</p></li>
<li><p><strong>yearbase</strong> (<em>int</em>) – Year when the data starts.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Datetime equivalent of day of year dates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D array</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-mxtoolbox.process.math_">
<span id="math-module"></span><h2>math_ module<a class="headerlink" href="#module-mxtoolbox.process.math_" title="Permalink to this headline">¶</a></h2>
<p>Mathematical, geometrical and simple matrix operations.</p>
<dl class="function">
<dt id="mxtoolbox.process.math_.broadcastable">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">broadcastable</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Return shape in which b could be broadcasted with a.</p>
<p>If arrays can not be broadcast None is returned, therefore this
function can also serve as a boolean test answering if b be broadcast
to a through appending through prepending and appending empty dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>ndarray</em>) – Array whose shape will not change.</p></li>
<li><p><strong>b</strong> (<em>ndarray</em>) – Array to broadcast to <cite>a</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If <cite>tuple</cite>, numpy.reshape(b, <cite>tuple</cite>) broadcasts to <cite>a</cite>, otherwise
arrays can not be broadcast.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple or None</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.circular_distance">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">circular_distance</code><span class="sig-paren">(</span><em class="sig-param">a1</em>, <em class="sig-param">a2</em>, <em class="sig-param">units='rad'</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.circular_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Function circdist usage:</p>
<blockquote>
<div><p>d   =   circdist(a1,a2,units=’rad’)</p>
</div></blockquote>
<p>Returns to ‘d’ the distance between angles a1 and a2
expected to be radians by default, or degrees if units
is specified to ‘deg’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a1, a2</strong> (<em>float</em>) – Input angle.</p></li>
<li><p><strong>units</strong> (<em>str</em>) – Units of input angles (‘deg’, ‘rad’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Angular distance between <cite>a1</cite> and <cite>a2</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.consecutive_duplicates">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">consecutive_duplicates</code><span class="sig-paren">(</span><em class="sig-param">x_pts</em>, <em class="sig-param">y_pts</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.consecutive_duplicates" title="Permalink to this definition">¶</a></dt>
<dd><p>Find consecutive duplicate coordinates in 2D space.</p>
<p>Given coordinates in 2D space <cite>x_pts</cite> and <cite>y_pts</cite>, a
consecutive duplicate point has the same x and y values
as the point before it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x_pts, y_pts</strong> (<em>1D array</em>) – Input coordinates in 2D space.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x_nd, y_nd</strong> (<em>1D array</em>) – Input coordinates with consecutive duplicates removed.</p></li>
<li><p><strong>duplicates</strong> (<em>1D array of bool</em>) – True at index value of consecutive duplicates.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.destination_point">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">destination_point</code><span class="sig-paren">(</span><em class="sig-param">x0</em>, <em class="sig-param">y0</em>, <em class="sig-param">distance</em>, <em class="sig-param">bearing</em>, <em class="sig-param">meters_per_unit=1000</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.destination_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Find coordinates of a point <cite>distance</cite> km in initial direction <cite>bearing</cite>.</p>
<p>Let <span class="math notranslate nohighlight">\(\lambda_0, \phi_0\)</span> be the longitude and latitude of some
initial coordinate. On a spherical earth, coordinates of a point
<span class="math notranslate nohighlight">\(\lambda_f, \phi_f\)</span> a distance <cite>d</cite> along a great-circle line
with initial bearing <span class="math notranslate nohighlight">\(\theta\)</span> can be computed as,</p>
<div class="math notranslate nohighlight">
\[\phi_f = \sin^{-1}\left(\sin\phi_0\cos\delta + \cos\phi_0\sin\delta\cos\theta\right)\]</div>
<p>and,</p>
<div class="math notranslate nohighlight">
\[\lambda_f = \lambda_0 + \tan^{-1}\left(\frac{\sin\theta\sin\delta\cos\phi_0}
{\cos\delta - \sin\phi_0\sin\phi_f}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta\)</span> is the <cite>d</cite> divided by the earth’s radius set
at 6371 km.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0, y0</strong> (<em>float</em>) – Starting longitude and latitude.</p></li>
<li><p><strong>distance</strong> (<em>float</em>) – Distance to travel.</p></li>
<li><p><strong>bearing</strong> (<em>float</em>) – Initial azimuth in degrees, 0 north and 90 east.</p></li>
<li><p><strong>meters_per_unit</strong> (<em>float</em>) – Defines the unit of <cite>distance</cite>. Defaults to 1000 for km.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Longitude and latitude of destination point.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.distance_along_bearing">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">distance_along_bearing</code><span class="sig-paren">(</span><em class="sig-param">xpts</em>, <em class="sig-param">ypts</em>, <em class="sig-param">bearing</em>, <em class="sig-param">x0=0</em>, <em class="sig-param">y0=0</em>, <em class="sig-param">dfunc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.distance_along_bearing" title="Permalink to this definition">¶</a></dt>
<dd><p>Return distance from (<cite>x0</cite>, <cite>y0</cite>) in an arbitrary direction.</p>
<p>Project coordinates defined by (<cite>xpts</cite>, <cite>ypts</cite>) to the nearest point
on a line passing through (<cite>x0</cite>, <cite>y0</cite>) and who’s angle to the x axis
is given by <cite>bearing</cite>. Then use <cite>dfunc</cite> to calculate distance of them
projected points to the origin. The distance function is assumed to
be of the form,</p>
<blockquote>
<div><p>distance = dfunc(xpts, x0, ypts, y0)</p>
</div></blockquote>
<p>and defautls to cartesian distance,</p>
<blockquote>
<div><p>distance = np.sqrt((xpts - x0) ** 2 + (ypts - y0) ** 2)</p>
</div></blockquote>
<p>Points where ypts &lt; y0 are returned as negative along the new dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xpts, ypts</strong> (<em>array_like</em>) – Input coordinates.</p></li>
<li><p><strong>bearing</strong> (<em>float</em>) – Direction along which to measure distance (degrees).</p></li>
<li><p><strong>x0, y0</strong> (<em>float</em>) – Origin coordinates.</p></li>
<li><p><strong>dfunc</strong> (<em>Object</em>) – Distance calculating function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Distance along new dimension.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.f_gaussian">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">f_gaussian</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">a_1</em>, <em class="sig-param">a_2</em>, <em class="sig-param">a_3</em>, <em class="sig-param">a_4</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.f_gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates,</p>
<div class="math notranslate nohighlight">
\[y = a_1 \exp\left(-\frac{(x - a_2)^2}{a_3}\right) + a_4\]</div>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.f_sine">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">f_sine</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">a_1</em>, <em class="sig-param">a_2</em>, <em class="sig-param">a_3</em>, <em class="sig-param">a_4</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.f_sine" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates,</p>
<div class="math notranslate nohighlight">
\[y = a_1 \sin\left((x - a_2)a_3\right) + a_4\]</div>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.haversine">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">haversine</code><span class="sig-paren">(</span><em class="sig-param">lon1</em>, <em class="sig-param">lat1</em>, <em class="sig-param">lon2</em>, <em class="sig-param">lat2</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.haversine" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the great circle distance between two points.</p>
<p>Used to calculate the distance between points defined in decimal
degrees. Uses the equation,</p>
<div class="math notranslate nohighlight">
\[h = 2R\sin^{-1}\left(\left[
\sin^{-1}\left(\frac{lat_2-lat_1}{2}\right)^2 +
\cos(lat_1)\cos(lat_2)\left(\frac{lon_2-lon_1}{2}\right)^2
\right]^{1/2}\right)\]</div>
<p>where the earth radius <cite>R</cite> is set to 6371 km.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon1, lat1</strong> (<em>float</em>) – Compare to this coordinate (decimal degrees).</p></li>
<li><p><strong>lon2, lat2</strong> (<em>array_like</em>) – Get distance from (<cite>lon1</cite>, <cite>lat1</cite>) for these coordinates (decimal degrees).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Distance between coordinates2 and coordinate1 (meters).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.increase_resolution">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">increase_resolution</code><span class="sig-paren">(</span><em class="sig-param">xpts</em>, <em class="sig-param">ypts</em>, <em class="sig-param">N</em>, <em class="sig-param">offset_idx=0</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.increase_resolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Get high resolution track from low resolution track.</p>
<p>Create a higher resolution track described in 2D by xpts and
ypts, 2 numpy 1D arrays, with N linearly equidistant points
added in between.</p>
<p>xpts and ypts are assumed to be longitudes and latitudes and
along track distance from the first point is returned in
km.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xpts, ypts</strong> (<em>array_like</em>) – Coordinates of low resolution track.</p></li>
<li><p><strong>N</strong> (<em>int</em>) – Number of points to have between input coordinates.</p></li>
<li><p><strong>offset_idx</strong> (<em>int</em>) – Index of the LR track used as origin in distance calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>array_like</em> – HR track horizontal coordinate.</p></li>
<li><p><em>array_like</em> – HR track vertical coordinate.</p></li>
<li><p><em>array_like</em> – HR track distance from origin.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.in_polygon">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">in_polygon</code><span class="sig-paren">(</span><em class="sig-param">xpts</em>, <em class="sig-param">ypts</em>, <em class="sig-param">x_poly</em>, <em class="sig-param">y_poly</em>, <em class="sig-param">lib='mpl'</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.in_polygon" title="Permalink to this definition">¶</a></dt>
<dd><p>Find points inside an arbitraty polygon.</p>
<p>Given coordinates of 2D space (<cite>xpts</cite>, <cite>ypts</cite>), returns a
boolean array of the same size as <cite>xpts</cite> and <cite>ypts</cite> where
True values indicate coordinates inside the polygon
defined by (<cite>x_poly</cite>, <cite>y_poly</cite>). Setting the <cite>lib</cite> parameter
chooses to use tools from matplotlib.path or shapely.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xpts, ypts</strong> (<em>array_like</em>) – Input coordinates.</p></li>
<li><p><strong>x_poly, y_poly</strong> (<em>array_like</em>) – Polygon coordinates.</p></li>
<li><p><strong>lib</strong> (<em>str</em>) – Library to use (‘mpl’ or ‘shp’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True for points inside polygon.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>boolean array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.get_contour_xy">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">get_contour_xy</code><span class="sig-paren">(</span><em class="sig-param">contour</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.get_contour_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return (x, y) coordinates of contour line.</p>
<p>Input is assumed to be a QuadContourSet object
containing only one contour line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>contour</strong> (<em>QuadContourSet</em>) – Object returned by matplotlib.pyplot.contour</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Coordinates (x, y) as array of shape (m, 2)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.project_to_line">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">project_to_line</code><span class="sig-paren">(</span><em class="sig-param">xpts</em>, <em class="sig-param">ypts</em>, <em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">c</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.project_to_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Find point on line nearest to coordinate.</p>
<p>Given the points (<cite>xpts</cite>, <cite>ypts</cite>) and line <cite>d</cite> defined by,</p>
<div class="math notranslate nohighlight">
\[ax + by + c = 0\]</div>
<p>coordinates on line <cite>d</cite> nearest to each point are given by,</p>
<div class="math notranslate nohighlight">
\[x = \frac{b(bx_{pts} - ay_{pts}) - ac}{a^2 + b^2}\]</div>
<p>and,</p>
<div class="math notranslate nohighlight">
\[y = \frac{a(-bx_{pts} - ay_{pts}) - bc}{a^2 + b^2}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xpts, ypts</strong> (<em>array_like</em>) – Coordinates to project on line.</p></li>
<li><p><strong>a, b, c</strong> (<em>float</em>) – Factors defining line <cite>d</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x, y</strong> – Points on line <cite>d</cite> nearest to each input coordinate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.proximity_group">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">proximity_group</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">distance</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.proximity_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Group consecutive array values by proximity.</p>
<p>Proximity grouping of values in an irregular but
monotonously increasing <cite>array</cite>. Adjacent values
are grouped if the distance between them is less than
or equal to <cite>distance</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>array_like</em>) – Monotonously increasing values.</p></li>
<li><p><strong>distance</strong> (<em>same type as array</em>) – Maximum distance to neighboor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>gid</strong> (<em>array_like</em>) – Group ID of each value in growing integers.</p></li>
<li><p><strong>gn</strong> (<em>array_like</em>) – Number of values per group.</p></li>
<li><p><strong>gindex</strong> (<em>list</em>) – Index values in <cite>array</cite> divided by group.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.polygon_area">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">polygon_area</code><span class="sig-paren">(</span><em class="sig-param">xpts</em>, <em class="sig-param">ypts</em>, <em class="sig-param">lonlat=False</em>, <em class="sig-param">pos=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.polygon_area" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.rotate_frame">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">rotate_frame</code><span class="sig-paren">(</span><em class="sig-param">u</em>, <em class="sig-param">v</em>, <em class="sig-param">angle</em>, <em class="sig-param">units='rad'</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.rotate_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Return 2D data in rotated frame of reference.</p>
<p>Rotates values of 2D vectors whose component values
are given by <cite>u</cite> and <cite>v</cite>. This function should be thought
of as rotating the frame of reference anti-clockwise by
<cite>angle</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u, v</strong> (<em>array_like</em>) – Eastward and northward vector components.</p></li>
<li><p><strong>angle</strong> (<em>float</em>) – Rotate the frame of reference by this value.</p></li>
<li><p><strong>units</strong> (<em>str (‘deg’ or ‘rad’)</em>) – Units of <cite>angle</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ur, vr</strong> – Vector components in rotated reference frame.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.xr_abs">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">xr_abs</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">field</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.xr_abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dataset dataset with field taken absolute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>xarray.Dataset</em>) – Dataset on which to operate.</p></li>
<li><p><strong>field</strong> (<em>str</em>) – Field to return as absolute.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataset with field made positive.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.xr_time_step">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">xr_time_step</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">tname</em>, <em class="sig-param">unit</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.xr_time_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Get median step of the time axis in dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>xarray.Dataset</em>) – Dataset on which to operate.</p></li>
<li><p><strong>tname</strong> (<em>str</em>) – Name of the time variable or coordinate.</p></li>
<li><p><strong>unit</strong> (<em>str (‘s’, ‘m’ or ‘h’)</em>) – Unit of the return value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Median time step.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.xr_unique">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">xr_unique</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">dim</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.xr_unique" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove duplicates along dimension <cite>dim</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>xarray.Dataset</em>) – Dataset to operate on.</p></li>
<li><p><strong>dim</strong> (<em>str</em>) – Name of dimension to operate along.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataset with duplicates removed along <cite>dim</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.mxy2abc">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">mxy2abc</code><span class="sig-paren">(</span><em class="sig-param">m</em>, <em class="sig-param">x0</em>, <em class="sig-param">y0</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.mxy2abc" title="Permalink to this definition">¶</a></dt>
<dd><p>For a line defined by,</p>
<div class="math notranslate nohighlight">
\[y = m (x - h) + b\]</div>
<p>reformulate as,</p>
<div class="math notranslate nohighlight">
\[ax + by + c = 0\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>m, x0, y0</strong> (<em>float</em>) – Line parameters in form 1.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>a, b, c</strong> – Line parameters in form 2.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-mxtoolbox.process.signal_">
<span id="signal-module"></span><h2>signal_ module<a class="headerlink" href="#module-mxtoolbox.process.signal_" title="Permalink to this headline">¶</a></h2>
<p>Analyses of 1D signal type datasets or multidimensional
arrays processed along one dimension. This includes
filtering and binning functions.</p>
<dl class="function">
<dt id="mxtoolbox.process.signal_.pd_bin">
<code class="sig-prename descclassname">mxtoolbox.process.signal_.</code><code class="sig-name descname">pd_bin</code><span class="sig-paren">(</span><em class="sig-param">dataframe</em>, <em class="sig-param">dim</em>, <em class="sig-param">binc</em>, <em class="sig-param">func=&lt;function nanmean&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.signal_.pd_bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin values in pandas dataframe.</p>
<p>Wrapper around xr_bin to allow bin averaging in pandas
dataframes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>pandas.Dataframe</em>) – Dataframe to operate on.</p></li>
<li><p><strong>dim</strong> (<em>str</em>) – Dimension to operate along</p></li>
<li><p><strong>binc</strong> (<em>array_like</em>) – Bin centers.</p></li>
<li><p><strong>func</strong> (<em>Object</em>) – Function used to reduce bin groups.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Input dataframe binned at <cite>binc</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.Dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.signal_.xr_at_var_max">
<code class="sig-prename descclassname">mxtoolbox.process.signal_.</code><code class="sig-name descname">xr_at_var_max</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">variable</em>, <em class="sig-param">dim=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.signal_.xr_at_var_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Return values of all others at variable max.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>xarray.Dataset</em>) – On which to operate.</p></li>
<li><p><strong>variable</strong> (<em>str</em>) – Name of the selector variable.</p></li>
<li><p><strong>dim</strong> (<em>str</em>) – Dimension along which to get maximum.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Reduced input dataset.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.signal_.xr_bin">
<code class="sig-prename descclassname">mxtoolbox.process.signal_.</code><code class="sig-name descname">xr_bin</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">dim</em>, <em class="sig-param">bins</em>, <em class="sig-param">centers=True</em>, <em class="sig-param">func=&lt;function nanmean&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.signal_.xr_bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin dataset along <cite>dim</cite>.</p>
<p>Convenience wrapper for the groupby_bins xarray method. Meant for
simply binning xarray <cite>dataset</cite> to the values of dimension <cite>dim</cite>, and
return values at bin centers (or edges) <cite>bins</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>xarray.Dataset or xarray.DataArray</em>) – Dataset to operate on.</p></li>
<li><p><strong>dim</strong> (<em>str</em>) – Name of dimension along which to bin.</p></li>
<li><p><strong>bins</strong> (<em>array_like</em>) – Bin centers or edges if <cite>centers</cite> is False.</p></li>
<li><p><strong>centers</strong> (<em>bool</em>) – Parameter <cite>bins</cite> is the centers, otherwise it is the edges.</p></li>
<li><p><strong>func</strong> (<em>Object</em>) – Function used to reduce bin groups.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataset binned at <cite>binc</cite> along <cite>dim</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.signal_.xr_bin_where">
<code class="sig-prename descclassname">mxtoolbox.process.signal_.</code><code class="sig-name descname">xr_bin_where</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">field</em>, <em class="sig-param">selector</em>, <em class="sig-param">dim</em>, <em class="sig-param">binc</em>, <em class="sig-param">fill_na=-99999</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.signal_.xr_bin_where" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin select values in all variables based on one variable.</p>
<p>Obtain the values of <cite>field</cite> chosen by <cite>selector</cite> and the
associated values of all other variables at the same
coordinates. For example, setting <cite>selector</cite> to <cite>np.argmax</cite>
will return the binned maximum of <cite>field</cite> and the values of
the other variables at the same coordinates (not necessarily
their maximums).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>xarray.Dataset</em>) – The dataset to operate on.</p></li>
<li><p><strong>field</strong> (<em>str</em>) – Name of variable off of which to base selection.</p></li>
<li><p><strong>selector</strong> (<em>callable</em>) – Returns index of selected value in each bin.</p></li>
<li><p><strong>dim</strong> (<em>str</em>) – Name of dimension along which to bin.</p></li>
<li><p><strong>binc</strong> (<em>1D array</em>) – Bin centers.</p></li>
<li><p><strong>fill_na</strong> (<em>numeric</em>) – Replace missing data in <cite>field</cite> with this value
prior to applying <cite>selector</cite>. Good values are function
dependent. For example you could use -99999 for
numpy.argmax and 99999 for numpy.argmin to not affect
the outcome.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The bin selected dataset.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The selector function is applied to the GroupBy objects
after binning. It is expected to return the index of
the selected value and not the selected value itself (e.g.
<cite>numpy.argmax</cite> or <cite>numpy.argmin</cite>).</p>
</div>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.signal_.xr_filtfilt">
<code class="sig-prename descclassname">mxtoolbox.process.signal_.</code><code class="sig-name descname">xr_filtfilt</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">dim</em>, <em class="sig-param">cutoff</em>, <em class="sig-param">btype='low'</em>, <em class="sig-param">order=2</em>, <em class="sig-param">vars_=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.signal_.xr_filtfilt" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass xarray data through variable state forward-backward filter.</p>
<p>Data is first gridded to a regular time vector going from the
first element of <cite>dataset[dim]</cite> to its last element. The resolution
used is the median time step of the input time coordinate. Forward-
backward filtering doubles the window’s order, so the input value
is integer divided by two. Odd order values will result in filtering
of order <cite>int(order / 2)</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>xarray.Dataset</em>) – Input data.</p></li>
<li><p><strong>dim</strong> (<em>str</em>) – Dimension along which to filter.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – Filter cutoff specified in Hz.</p></li>
<li><p><strong>btype</strong> (<em>str</em>) – Filter type passed to scipy.signal.butter.</p></li>
<li><p><strong>order</strong> (<em>int</em>) – Filter order passed to scipy.signal.butter.</p></li>
<li><p><strong>vars_</strong> (<em>list of str</em>) – Variables to filter, defaults to all.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The filtered input dataset</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.signal_.xr_godin">
<code class="sig-prename descclassname">mxtoolbox.process.signal_.</code><code class="sig-name descname">xr_godin</code><span class="sig-paren">(</span><em class="sig-param">dataarray</em>, <em class="sig-param">tname</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.signal_.xr_godin" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply Godin filter to <cite>dataarray</cite> along time dimension.</p>
<p>Godin filtering is meant to remove the semi-diurnal and
diurnal components of tide. It consists of iteratively
time averaging over 24, 24, and 25 hours, and then
downsampling to the daily scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataarray</strong> (<em>xarray.DataArray</em>) – DataArray on which to operate.</p></li>
<li><p><strong>tname</strong> (<em>str</em>) – Name of the time dimension.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Godin filtered DataArray.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.signal_.xr_peaks">
<code class="sig-prename descclassname">mxtoolbox.process.signal_.</code><code class="sig-name descname">xr_peaks</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">th_array</em>, <em class="sig-param">tname</em>, <em class="sig-param">two_sided=True</em>, <em class="sig-param">fp_kwargs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.signal_.xr_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Find peaks in xarray dataset.</p>
<p>!!!The UI here needs to be reworked and tested!!!</p>
<p>Wrapper of scipy.signal.find_peaks that takes as input the array in which
to find peaks, the variable threshold array ‘th_array’ and their matching
x coordinate name ‘tname’. If two_sided is True, positive and negative peaks
above the threshold will be returned.</p>
<p>out is a tuple formed of DataArrays for high peaks, low peaks (two_sided=True), and
index of peaks in original array.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">process subpackage</a><ul>
<li><a class="reference internal" href="#module-mxtoolbox.process.analyses">analyses module</a></li>
<li><a class="reference internal" href="#module-mxtoolbox.process.convert">convert module</a></li>
<li><a class="reference internal" href="#module-mxtoolbox.process.math_">math_ module</a></li>
<li><a class="reference internal" href="#module-mxtoolbox.process.signal_">signal_ module</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="mxtoolbox.plot.html"
                        title="previous chapter">plot subpackage</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="mxtoolbox.read.html"
                        title="next chapter">read subpackage</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/source/mxtoolbox.process.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mxtoolbox.read.html" title="read subpackage"
             >next</a> |</li>
        <li class="right" >
          <a href="mxtoolbox.plot.html" title="plot subpackage"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">mxtoolbox April 2020 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Jean-Luc Shaw.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.0.
    </div>
  </body>
</html>