
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>process subpackage &#8212; mxtoolbox April 2020 documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="read subpackage" href="mxtoolbox.read.html" />
    <link rel="prev" title="plot subpackage" href="mxtoolbox.plot.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mxtoolbox.read.html" title="read subpackage"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mxtoolbox.plot.html" title="plot subpackage"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">mxtoolbox April 2020 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="process-subpackage">
<h1>process subpackage<a class="headerlink" href="#process-subpackage" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-mxtoolbox.process.analyses">
<span id="analyses-module"></span><h2>analyses module<a class="headerlink" href="#module-mxtoolbox.process.analyses" title="Permalink to this headline">¶</a></h2>
<p>Complex analyses transforming data into other data.</p>
<dl class="function">
<dt id="mxtoolbox.process.analyses.pca">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">pca</code><span class="sig-paren">(</span><em class="sig-param">input_</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.pca" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform principal component analysis on numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_</strong> (<em>2D array</em>) – Columns (n) are variables, rows (m) are observations.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>U</strong> (<em>2D array (n by n)</em>) – Columns are the eigenvectors.</p></li>
<li><p><strong>lbda</strong> (<em>1D array</em>) – Eigenvalues.</p></li>
<li><p><strong>F</strong> (<em>2D array</em>) – Matrix of component scores.</p></li>
<li><p><strong>UL_sr</strong> (<em>2D array</em>) – Projection of the descriptors to PC space.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Implemented following,</p>
<p>Legendre and Legendre (1998), Numerical Ecology, Elsevier, 852 pp.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.analyses.pd_pca">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">pd_pca</code><span class="sig-paren">(</span><em class="sig-param">dataframe</em>, <em class="sig-param">features</em>, <em class="sig-param">target=None</em>, <em class="sig-param">plot=False</em>, <em class="sig-param">**plt_kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.pd_pca" title="Permalink to this definition">¶</a></dt>
<dd><p>Add principal component vectors to dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>pandas.DataFrame</em>) – Data to analyse.</p></li>
<li><p><strong>features</strong> (<em>list of str</em>) – Descriptors to use.</p></li>
<li><p><strong>target</strong> (<em>str</em>) – Name of target column.</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – Visualize results.</p></li>
<li><p><strong>plt_kwargs</strong> (<em>dict</em>) – Keyword arguments passed to pandas.plot.scatter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>pcdf</strong> (<em>pandas.Dataframe</em>) – Input dataframe with added PC columns.</p></li>
<li><p><strong>lbda</strong> (<em>1D array</em>) – Eigenvalues of principal modes.</p></li>
<li><p><strong>UL_sr</strong> (<em>2D array</em>) – Projection of features to reduced space.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.analyses.principal_modes">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">principal_modes</code><span class="sig-paren">(</span><em class="sig-param">args</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.principal_modes" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform eigenvalue decomposition using numpy.</p>
<p>Given a dataset described by <cite>n</cite> vectors of length
<cite>m</cite>, the principal modes of variation can be extracted
using eigenvalue decomposition. The <cite>n</cite> vectors are
first detrended by subtracting the mean. A covariance
matrix <cite>R</cite> is then calculated as,</p>
<div class="math notranslate nohighlight">
\[\mathbf{R} = \mathbf{F}\cdot\mathbf{F'}\]</div>
<p>where <span class="math notranslate nohighlight">\(F\)</span> is a matrix whose columns are formed from
the <cite>n</cite> detrended input vectors. This matrix is then
passed to <cite>numpy.linalg.eig</cite> whose outputs <cite>w</cite> and <cite>v</cite>
are returned.</p>
<p>In addition, the matrix <span class="math notranslate nohighlight">\(\mathbf{v}\)</span> is
inverted and returned as <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> to provide
a basis change matrix into principal mode space. The
orginal coordinates may then be rotated into principal
mode space by arranging them into the <cite>n</cite> by <cite>m</cite> matrix
<span class="math notranslate nohighlight">\(O\)</span> by multiplication,</p>
<div class="math notranslate nohighlight">
\[\mathbf{C} = \mathbf{B}\cdot\mathbf{O}\]</div>
<p>we get the matrix <cite>n</cite> by <cite>m</cite> matrix <span class="math notranslate nohighlight">\(c\)</span> whose rows
are the rotated vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> (<em>tuple</em>) – Vectors of length m.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>vals</strong> (<em>array (n)</em>) – Eigenvalues of the covariance matrix.</p></li>
<li><p><strong>vecs</strong> (<em>ndarray (n by n)</em>) – Eigenvectors (columns).</p></li>
<li><p><strong>B</strong> (<em>ndarray (n by n)</em>) – Basis change matrix.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.analyses.gaussian_smoothing">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">gaussian_smoothing</code><span class="sig-paren">(</span><em class="sig-param">xs</em>, <em class="sig-param">ys</em>, <em class="sig-param">zs</em>, <em class="sig-param">xg</em>, <em class="sig-param">yg</em>, <em class="sig-param">XR=1.0</em>, <em class="sig-param">YR=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.gaussian_smoothing" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates scattered data to grid via Gaussian smoothing.</p>
<p>Simplified version of the Barnes smoothing algorithm. This
routine computes a value for each grid point by averaging
all scattered data are weighted by their distance to the grid
point. The weighing function for scatter point <cite>i</cite> is,</p>
<div class="math notranslate nohighlight">
\[w_i = \text{exp}\left[-\left(\frac{xg-xs_i}{XR}\right)^2 +
                 \left(\frac{yg-ys_i}{YR}\right)^2\right]\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xs, ys</strong> (<em>1D array</em>) – Coordinates of the scattered data.</p></li>
<li><p><strong>zs</strong> (<em>1D array</em>) – Values of the scattered data.</p></li>
<li><p><strong>xg, yg</strong> (<em>2D array</em>) – Grid coordinates.</p></li>
<li><p><strong>XR, YR</strong> (<em>float</em>) – Horizontal and vertical search radius.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>zg</strong> – Scattered data interpolated to grid.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.analyses.lsq_curve_fit">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">lsq_curve_fit</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">*parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.lsq_curve_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Least squares fitting using scipy.optimize.</p>
<p>Formatting input for scipy.optimize.leastsq can
be confusing. This wrapper serves the purpose of
not having to remember how it works.</p>
<p>Let <span class="math notranslate nohighlight">\(y=f(x)\)</span> and <cite>g</cite> be a model for <cite>f</cite>
dependent on a variable number of parameters
<span class="math notranslate nohighlight">\(\mathbf{a}\)</span>. Then this routine requires
requires <cite>model</cite> to be a function object taking
as arguments <cite>x</cite>, <span class="math notranslate nohighlight">\(a_1, a_2, ..., a_n\)</span> in this
order, and <cite>*parameters</cite> to be ordered initial guesses
for <span class="math notranslate nohighlight">\(\mathbf{a}\)</span>.</p>
<p>The following predefined models can serve as examples
and can be called by setting <cite>model</cite> to the function
name.</p>
<ul class="simple">
<li><p>mxtoolbox.process.math.f_gaussian</p></li>
<li><p>mxtoolbox.process.math.f_sine</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>function object or str</em>) – Must be of form <cite>y = model(x, a_1, a_2, …)</cite></p></li>
<li><p><strong>x, y</strong> (<em>1D array</em>) – Dependent and independent variables.</p></li>
<li><p><strong>parameters</strong> (<em>tuple of floats</em>) – Ordered initial guesses for <span class="math notranslate nohighlight">\(\mathbf{a}\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fit_values</strong> (<em>1D array</em>) – model(<cite>x</cite>, a_1, a_2, …) using optimized parameters.</p></li>
<li><p><strong>fit_parameters</strong> (<em>1D array</em>) – Optimized model parameters.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.analyses.pd_regression_statistics">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">pd_regression_statistics</code><span class="sig-paren">(</span><em class="sig-param">dataframe</em>, <em class="sig-param">xname</em>, <em class="sig-param">yname</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.pd_regression_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Print analysis of variance on linear regression.</p>
<p>Print analysis of variance (ANOVA) table for a linear regression
drawn for yname from xname, two columns of dataframe. The independent
variable is considered to be xname.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>pandas.Dataframe</em>) – The dataframe to operate on.</p></li>
<li><p><strong>xname</strong> (<em>str</em>) – Column name of the independent variable.</p></li>
<li><p><strong>yname</strong> (<em>str</em>) – Column name of the dependent variable.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>Van Emden, Helmut (2008)
Statistics for terrified biologists,
Blackwell publishing
p. 262</p>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.analyses.xr_2D_to_1D_interp">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">xr_2D_to_1D_interp</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">xcoord</em>, <em class="sig-param">ycoord</em>, <em class="sig-param">name</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.xr_2D_to_1D_interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate 2D field along arbitrary track.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>xarray.Dataset or xarray.DataArray</em>) – Data from which to interpolate.</p></li>
<li><p><strong>x, y</strong> (<em>1D array</em>) – Coordinates of interpolation track.</p></li>
<li><p><strong>xcoord, ycoord</strong> (<em>str</em>) – Coordinate names of the 2D field.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – Name of the track coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Field interpolated to track.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xarray.Dataset or xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.analyses.xr_cross_correlate">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">xr_cross_correlate</code><span class="sig-paren">(</span><em class="sig-param">dataarray_a</em>, <em class="sig-param">dataarray_b</em>, <em class="sig-param">coord='time'</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.xr_cross_correlate" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute cross correlation between DataArrays dataarray_a and dataarray_b.</p>
<p>The two input arrays can contain NaN values and be of different
lengths but they must have the same coordinate resolution
and coordinates must match on overlap. Resample prior to
using if necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataarray_a, dataarray_b</strong> (<em>xarray.DataArray</em>) – Arrays to correlate.</p></li>
<li><p><strong>coord</strong> (<em>str</em>) – Name of dimension along which to operate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>tau</strong> (<em>float</em>) – dataarray_a shifted forward by <cite>tau</cite> matches dataarray_b</p></li>
<li><p><strong>r2</strong> (<em>float</em>) – Variance explained at maximum cross correlation.</p></li>
<li><p><strong>dataarray_c</strong> (<em>xarray.DataArray</em>) – dataarray_b shifted to maximum correlation.</p></li>
<li><p><strong>cc</strong> (<em>1D array</em>) – Cross correlation vector.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.analyses.xr_time_aht">
<code class="sig-prename descclassname">mxtoolbox.process.analyses.</code><code class="sig-name descname">xr_time_aht</code><span class="sig-paren">(</span><em class="sig-param">sl</em>, <em class="sig-param">h='h'</em>, <em class="sig-param">period=12.4</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.analyses.xr_time_aht" title="Permalink to this definition">¶</a></dt>
<dd><p>Function xr_t_aht summary:</p>
<p>A much simplified version of libmx.physics.ocn.t_aht_ast</p>
<p>Serves as validation of the aforementioned code and as a fast
way to get time aht from a libmx.physics.xri.sealev xarray
object.</p>
<p>Parameters:</p>
<p>sl: sealev object
h: either ‘h’ or ‘hp’ to use measure or predicted sea level
period: defaults to 12.40 hours (semidiurnal). This adjusts
the required distance between high tides as well as the filtering
frequency.</p>
</dd></dl>

</div>
<div class="section" id="module-mxtoolbox.process.convert">
<span id="convert-module"></span><h2>convert module<a class="headerlink" href="#module-mxtoolbox.process.convert" title="Permalink to this headline">¶</a></h2>
<p>Simple data conversions. Includes unit conversions and thermodynamic property
conversions.</p>
<dl class="function">
<dt id="mxtoolbox.process.convert.anomaly2rgb">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">anomaly2rgb</code><span class="sig-paren">(</span><em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.anomaly2rgb" title="Permalink to this definition">¶</a></dt>
<dd><p>Map standardized anomaly to discretized red to blue color scheme.</p>
<p>Returns an RGB triplet according to standardized anomaly value
passed as argument. Colors are defined in intervals of 0.5 std and
saturate at -2 and 2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>value</strong> (<em>float</em>) – Standardized anomaly value.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RGB triplet.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.binc2edge">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">binc2edge</code><span class="sig-paren">(</span><em class="sig-param">z</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.binc2edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Get bin edges from bin centers.</p>
<p>Bin centers can be irregularly spaced. Edges are halfway between
one point and the next.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>numpy.array, pandas.DatetimeIndex, pandas.Series</em>) – Bin centers.</p></li>
<li><p><strong>Returns</strong></p></li>
<li><p><strong>numpy.array, pandas.DatetimeIndex, pandas.Series</strong> – Bin edges.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.hd2uv">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">hd2uv</code><span class="sig-paren">(</span><em class="sig-param">heading</em>, <em class="sig-param">magnitude</em>, <em class="sig-param">rotate_by=0</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.hd2uv" title="Permalink to this definition">¶</a></dt>
<dd><p>Return u, v vector components from heading and magnitude.</p>
<p><cite>heading</cite> is assumed to start from North at 0 and rotate clockwise (90 at
East). The components can be returned in a frame of reference rotated
clockwise by setting <cite>rotate_by</cite> in degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>heading</strong> (<em>array_like</em>) – Compass direction (degrees).</p></li>
<li><p><strong>magnitude</strong> (<em>array_like</em>) – Vector norm.</p></li>
<li><p><strong>rotate_by</strong> (<em>float</em>) – Theta direction of returned <cite>u</cite> component.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>u, v</strong> – Vector components in chosen frame of reference.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.pd_add_seasons">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">pd_add_seasons</code><span class="sig-paren">(</span><em class="sig-param">dataframe</em>, <em class="sig-param">time='time'</em>, <em class="sig-param">stype='astro'</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.pd_add_seasons" title="Permalink to this definition">¶</a></dt>
<dd><p>Add season column to a dataframe containing a datetime column. The name
of the datetime column can be specified in parameter time. Astronimical
or meteorological seasons can be returned by specifiying ‘astro’ or
or ‘met’ at the stype parameter. Astronomical seasons are taken to start
on the 20th (near the solstice and equinoxes) and meteorological seasons
are given starting one the 1st of the months containing the solstices and
equinoxes.</p>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.tetha2hd">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">tetha2hd</code><span class="sig-paren">(</span><em class="sig-param">angle</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.tetha2hd" title="Permalink to this definition">¶</a></dt>
<dd><p>Function tta2hd usage :           output    = tta2hd(angle)</p>
<p>Takes as angle angle vector in cartesian coordinates running counter-
clockwise from 0 (east) to 360 degrees and transforms it into a heading
vector running clockwise from 0 to the north to 360 degrees.</p>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.uv2hd">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">uv2hd</code><span class="sig-paren">(</span><em class="sig-param">u</em>, <em class="sig-param">v</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.uv2hd" title="Permalink to this definition">¶</a></dt>
<dd><p>Function uv2hd usage :          nm, hd      = uv2hd(u,v)</p>
<p>Converts vector components (u in the abscissa and v in the ordinates) of a 2D space
to a heading angle ‘hd’ in degrees with 0 towards positive y and 90 towards positive x.
Also returns the norm of vector (u,v) to variable ‘nm’.</p>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.convert.xr_SA_CT_pden">
<code class="sig-prename descclassname">mxtoolbox.process.convert.</code><code class="sig-name descname">xr_SA_CT_pden</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">t='temperature'</em>, <em class="sig-param">s='salinity'</em>, <em class="sig-param">p='z'</em>, <em class="sig-param">lon='longitude'</em>, <em class="sig-param">lat='latitude'</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.convert.xr_SA_CT_pden" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an xarray dataset width added CT, SA and sigma0
columns as calculated by the Gibbs Seawater package gsw.</p>
</dd></dl>

</div>
<div class="section" id="module-mxtoolbox.process.math_">
<span id="math-module"></span><h2>math_ module<a class="headerlink" href="#module-mxtoolbox.process.math_" title="Permalink to this headline">¶</a></h2>
<p>Mathematical, geometrical and simple matrix operations.</p>
<dl class="function">
<dt id="mxtoolbox.process.math_.broadcastable">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">broadcastable</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.broadcastable" title="Permalink to this definition">¶</a></dt>
<dd><p>Return shape in which b could be broadcasted with a.</p>
<p>If arrays can not be broadcast None is returned, therefore this
function can also serve as a boolean test answering if b be broadcast
to a through appending through prepending and appending empty dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>ndarray</em>) – Array whose shape will not change.</p></li>
<li><p><strong>b</strong> (<em>ndarray</em>) – Array to broadcast to <cite>a</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If <cite>tuple</cite>, numpy.reshape(b, <cite>tuple</cite>) broadcasts to <cite>a</cite>, otherwise
arrays can not be broadcast.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple or None</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.circular_distance">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">circular_distance</code><span class="sig-paren">(</span><em class="sig-param">a1</em>, <em class="sig-param">a2</em>, <em class="sig-param">units='rad'</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.circular_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Function circdist usage:</p>
<blockquote>
<div><p>d   =   circdist(a1,a2,units=’rad’)</p>
</div></blockquote>
<p>Returns to ‘d’ the distance between angles a1 and a2
expected to be radians by default, or degrees if units
is specified to ‘deg’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a1, a2</strong> (<em>float</em>) – Input angle.</p></li>
<li><p><strong>units</strong> (<em>str</em>) – Units of input angles (‘deg’, ‘rad’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Angular distance between <cite>a1</cite> and <cite>a2</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.distance_along_bearing">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">distance_along_bearing</code><span class="sig-paren">(</span><em class="sig-param">xpts</em>, <em class="sig-param">ypts</em>, <em class="sig-param">bearing</em>, <em class="sig-param">x0=0</em>, <em class="sig-param">y0=0</em>, <em class="sig-param">dfunc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.distance_along_bearing" title="Permalink to this definition">¶</a></dt>
<dd><p>Return distance from (<cite>x0</cite>, <cite>y0</cite>) in an arbitrary direction.</p>
<p>Project coordinates defined by (<cite>xpts</cite>, <cite>ypts</cite>) to the nearest point
on a line passing through (<cite>x0</cite>, <cite>y0</cite>) and who’s angle to the x axis
is given by <cite>bearing</cite>. Then use <cite>dfunc</cite> to calculate distance of them
projected points to the origin. The distance function is assumed to
be of the form,</p>
<blockquote>
<div><p>distance = dfunc(xpts, x0, ypts, y0)</p>
</div></blockquote>
<p>and defautls to cartesian distance,</p>
<blockquote>
<div><p>distance = np.sqrt((xpts - x0) ** 2 + (ypts - y0) ** 2)</p>
</div></blockquote>
<p>Points where ypts &lt; y0 are returned as negative along the new dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xpts, ypts</strong> (<em>array_like</em>) – Input coordinates.</p></li>
<li><p><strong>bearing</strong> (<em>float</em>) – Direction along which to measure distance (degrees).</p></li>
<li><p><strong>x0, y0</strong> (<em>float</em>) – Origin coordinates.</p></li>
<li><p><strong>dfunc</strong> (<em>Object</em>) – Distance calculating function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Distance along new dimension.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.f_gaussian">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">f_gaussian</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">a_1</em>, <em class="sig-param">a_2</em>, <em class="sig-param">a_3</em>, <em class="sig-param">a_4</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.f_gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates,</p>
<div class="math notranslate nohighlight">
\[y = a_1 \exp\left(-\frac{(x - a_2)^2}{a_3}\right) + a_4\]</div>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.f_sine">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">f_sine</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">a_1</em>, <em class="sig-param">a_2</em>, <em class="sig-param">a_3</em>, <em class="sig-param">a_4</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.f_sine" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates,</p>
<div class="math notranslate nohighlight">
\[y = a_1 \sin\left((x - a_2)a_3\right) + a_4\]</div>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.haversine">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">haversine</code><span class="sig-paren">(</span><em class="sig-param">lon1</em>, <em class="sig-param">lat1</em>, <em class="sig-param">lon2</em>, <em class="sig-param">lat2</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.haversine" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the great circle distance between two points.</p>
<p>Used to calculate the distance between points defined in decimal
degrees. Uses the equation,</p>
<div class="math notranslate nohighlight">
\[h = 2R\sin^{-1}\left(\left[
\sin^{-1}\left(\frac{lat_2-lat_1}{2}\right)^2 +
\cos(lat_1)\cos(lat_2)\left(\frac{lon_2-lon_1}{2}\right)^2
\right]^{1/2}\right)\]</div>
<p>where the earth radius <cite>R</cite> is set to 6371 km.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon1, lat1</strong> (<em>float</em>) – Compare to this coordinate (decimal degrees).</p></li>
<li><p><strong>lon2, lat2</strong> (<em>array_like</em>) – Get distance from (<cite>lon1</cite>, <cite>lat1</cite>) for these coordinates (decimal degrees).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Distance between coordinates2 and coordinate1 (meters).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.increase_resolution">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">increase_resolution</code><span class="sig-paren">(</span><em class="sig-param">xpts</em>, <em class="sig-param">ypts</em>, <em class="sig-param">N</em>, <em class="sig-param">offset_idx=0</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.increase_resolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Get high resolution track from low resolution track.</p>
<p>Create a higher resolution track described in 2D by xpts and
ypts, 2 numpy 1D arrays, with N linearly equidistant points
added in between.</p>
<p>xpts and ypts are assumed to be longitudes and latitudes and
along track distance from the first point is returned in
km.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xpts, ypts</strong> (<em>array_like</em>) – Coordinates of low resolution track.</p></li>
<li><p><strong>N</strong> (<em>int</em>) – Number of points to have between input coordinates.</p></li>
<li><p><strong>offset_idx</strong> (<em>int</em>) – Index of the LR track used as origin in distance calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>array_like</em> – HR track horizontal coordinate.</p></li>
<li><p><em>array_like</em> – HR track vertical coordinate.</p></li>
<li><p><em>array_like</em> – HR track distance from origin.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.in_polygon">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">in_polygon</code><span class="sig-paren">(</span><em class="sig-param">xpts</em>, <em class="sig-param">ypts</em>, <em class="sig-param">x_poly</em>, <em class="sig-param">y_poly</em>, <em class="sig-param">lib='mpl'</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.in_polygon" title="Permalink to this definition">¶</a></dt>
<dd><p>Find points inside an arbitraty polygon.</p>
<p>Given coordinates of 2D space (<cite>xpts</cite>, <cite>ypts</cite>), returns a
boolean array of the same size as <cite>xpts</cite> and <cite>ypts</cite> where
True values indicate coordinates inside the polygon
defined by (<cite>x_poly</cite>, <cite>y_poly</cite>). Setting the <cite>lib</cite> parameter
chooses to use tools from matplotlib.path or shapely.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xpts, ypts</strong> (<em>array_like</em>) – Input coordinates.</p></li>
<li><p><strong>x_poly, y_poly</strong> (<em>array_like</em>) – Polygon coordinates.</p></li>
<li><p><strong>lib</strong> (<em>str</em>) – Library to use (‘mpl’ or ‘shp’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True for points inside polygon.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>boolean array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.get_contour_xy">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">get_contour_xy</code><span class="sig-paren">(</span><em class="sig-param">contour</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.get_contour_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return (x, y) coordinates of contour line.</p>
<p>Input is assumed to be a QuadContourSet object
containing only one contour line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>contour</strong> (<em>QuadContourSet</em>) – Object returned by matplotlib.pyplot.contour</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Coordinates (x, y) as array of shape (m, 2)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.project_to_line">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">project_to_line</code><span class="sig-paren">(</span><em class="sig-param">xpts</em>, <em class="sig-param">ypts</em>, <em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">c</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.project_to_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Find point on line nearest to coordinate.</p>
<p>Given the points (<cite>xpts</cite>, <cite>ypts</cite>) and line <cite>d</cite> defined by,</p>
<div class="math notranslate nohighlight">
\[ax + by + c = 0\]</div>
<p>coordinates on line <cite>d</cite> nearest to each point are given by,</p>
<div class="math notranslate nohighlight">
\[x = \frac{b(bx_{pts} - ay_{pts}) - ac}{a^2 + b^2}\]</div>
<p>and,</p>
<div class="math notranslate nohighlight">
\[y = \frac{a(-bx_{pts} - ay_{pts}) - bc}{a^2 + b^2}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xpts, ypts</strong> (<em>array_like</em>) – Coordinates to project on line.</p></li>
<li><p><strong>a, b, c</strong> (<em>float</em>) – Factors defining line <cite>d</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x, y</strong> – Points on line <cite>d</cite> nearest to each input coordinate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.proximity_group">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">proximity_group</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">distance</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.proximity_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Group consecutive array values by proximity.</p>
<p>Proximity grouping of values in an irregular but
monotonously increasing <cite>array</cite>. Adjacent values
are grouped if the distance between them is less than
or equal to <cite>distance</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>array_like</em>) – Monotonously increasing values.</p></li>
<li><p><strong>distance</strong> (<em>same type as array</em>) – Maximum distance to neighboor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>gid</strong> (<em>array_like</em>) – Group ID of each value in growing integers.</p></li>
<li><p><strong>gn</strong> (<em>array_like</em>) – Number of values per group.</p></li>
<li><p><strong>gindex</strong> (<em>list</em>) – Index values in <cite>array</cite> divided by group.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.polygon_area">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">polygon_area</code><span class="sig-paren">(</span><em class="sig-param">xpts</em>, <em class="sig-param">ypts</em>, <em class="sig-param">lonlat=False</em>, <em class="sig-param">pos=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.polygon_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute polygon area.</p>
<p>Use Greene’s theorem to compute polygon area. Input vectors
can be longitudes and latitudes if lonlat is specified. Otherwise
they are assumed coordinates of linear space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xpts, ypts</strong> (<em>array like</em>) – Polygon coordinates.</p></li>
<li><p><strong>lonlat</strong> (<em>bool</em>) – If input is lonlat, convert to CEA projection.</p></li>
<li><p><strong>pos</strong> (<em>bool</em>) – Return absolute value of area, defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Polygon area. Units are coordinate dependent.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.rotate_frame">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">rotate_frame</code><span class="sig-paren">(</span><em class="sig-param">u</em>, <em class="sig-param">v</em>, <em class="sig-param">angle</em>, <em class="sig-param">units='rad'</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.rotate_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Return 2D data in rotated frame of reference.</p>
<p>Rotates values of 2D vectors whose component values
are given by <cite>u</cite> and <cite>v</cite>. This function should be thought
of as rotating the frame of reference anti-clockwise by
<cite>angle</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u, v</strong> (<em>array_like</em>) – Eastward and northward vector components.</p></li>
<li><p><strong>angle</strong> (<em>float</em>) – Rotate the frame of reference by this value.</p></li>
<li><p><strong>units</strong> (<em>str (‘deg’ or ‘rad’)</em>) – Units of <cite>angle</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ur, vr</strong> – Vector components in rotated reference frame.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.xr_abs">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">xr_abs</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">field</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.xr_abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dataset dataset with field taken absolute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>xarray.Dataset</em>) – Dataset on which to operate.</p></li>
<li><p><strong>field</strong> (<em>str</em>) – Field to return as absolute.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataset with field made positive.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.xr_time_step">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">xr_time_step</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">tname</em>, <em class="sig-param">unit</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.xr_time_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Get median step of the time axis in dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>xarray.Dataset</em>) – Dataset on which to operate.</p></li>
<li><p><strong>tname</strong> (<em>str</em>) – Name of the time variable or coordinate.</p></li>
<li><p><strong>unit</strong> (<em>str (‘s’, ‘m’ or ‘h’)</em>) – Unit of the return value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Median time step.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.xr_unique">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">xr_unique</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">dim</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.xr_unique" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove duplicates along dimension <cite>dim</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>xarray.Dataset</em>) – Dataset to operate on.</p></li>
<li><p><strong>dim</strong> (<em>str</em>) – Name of dimension to operate along.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataset with duplicates removed along <cite>dim</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.math_.mxy2abc">
<code class="sig-prename descclassname">mxtoolbox.process.math_.</code><code class="sig-name descname">mxy2abc</code><span class="sig-paren">(</span><em class="sig-param">m</em>, <em class="sig-param">x0</em>, <em class="sig-param">y0</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.math_.mxy2abc" title="Permalink to this definition">¶</a></dt>
<dd><p>For a line defined by,</p>
<div class="math notranslate nohighlight">
\[y = m (x - h) + b\]</div>
<p>reformulate as,</p>
<div class="math notranslate nohighlight">
\[ax + by + c = 0\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>m, x0, y0</strong> (<em>float</em>) – Line parameters in form 1.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>a, b, c</strong> – Line parameters in form 2.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-mxtoolbox.process.shp2dex">
<span id="shp2dex-module"></span><h2>shp2dex module<a class="headerlink" href="#module-mxtoolbox.process.shp2dex" title="Permalink to this headline">¶</a></h2>
<p>Convert Canadian ice service (CIS) ESRI shapefiles to ascii format (dex).</p>
<p>CIS daily ice analysis charts (dailys) and regional analysis charts (weeklys) are
collected every day on mixing and processed to provide information such as,</p>
<blockquote>
<div><ul class="simple">
<li><p>Ice thickness maps.</p></li>
<li><p>First occurence maps.</p></li>
<li><p>Total gulf, Newfoundland shelf and Scotian Shelf ice volumes.</p></li>
<li><p>Comparisons to climatology.</p></li>
</ul>
</div></blockquote>
<p>These analyses are performed by a combination of Perl/awk routines and are
facilitated by first transforming the shapefiles to gridded ascii plain text
in a format called dex, containing geographical coordinates and egg code data.
Time information is carried by the file name (YYYYMMDD) and the columns in
the file are ordered as follows,</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Longitude (west)</p></li>
<li><p>Latitude</p></li>
<li><p>Total ice concentration</p></li>
<li><p>Partial ice concentration (thickest ice)</p></li>
<li><p>Stage of developpment (thickest ice)</p></li>
<li><p>Form of ice (thickest ice)</p></li>
<li><p>Partial ice concentration (second thickest ice)</p></li>
<li><p>Stage of developpment (second thickest ice)</p></li>
<li><p>Form of ice (second thickest ice)</p></li>
<li><p>Partial ice concentration (third thickest ice)</p></li>
<li><p>Stage of developpment (third thickest ice)</p></li>
<li><p>Form of ice (third thickest ice)</p></li>
</ol>
</div></blockquote>
<p>This module performs the conversion and is meant to be called from command
line. Command line interface description can be shown by entering,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ shp2dex -h
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>More background information can be found at the following links:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://www.canada.ca/en/environment-climate-change/services/weather-manuals-documentation/manice-manual-of-ice/chapter-5.htm">About the Egg code and CIS data products.</a></p></li>
</ul>
<ul class="simple">
<li><p><a class="reference external" href="https://www.jcomm.info/index.php?option=com_oe&amp;task=viewDocumentRecord&amp;docID=4439">About the SIGRID-3 shapefile format used by the CIS.</a></p></li>
</ul>
<ul class="simple">
<li><p><a class="reference external" href="https://www.canada.ca/en/environment-climate-change/services/ice-forecasts-observations/latest-conditions/glossary.html">CIS sea ice glossary.</a></p></li>
</ul>
</div></blockquote>
</div>
<dl class="function">
<dt id="mxtoolbox.process.shp2dex.load_cis_shp">
<code class="sig-prename descclassname">mxtoolbox.process.shp2dex.</code><code class="sig-name descname">load_cis_shp</code><span class="sig-paren">(</span><em class="sig-param">name</em>, <em class="sig-param">ascending=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.shp2dex.load_cis_shp" title="Permalink to this definition">¶</a></dt>
<dd><p>Read CIS shapefile to dataframe and polygon list.</p>
<p>Creates a pandas DataFrame with records from the <cite>.dbf</cite>
companion file as rows and the field names as columns. The
dataframe is also sorted by polygon area as this is needed
further down the processing chain. For uniformity, empty
strings in records are replaced by ‘X’. A reference to the
shape object of each record is found in column <cite>shapes</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – Path and name to input shapefile (.shp).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>dataframe</strong> (<em>pandas.DataFrame</em>) – Shapefile record and field information.</p></li>
<li><p><strong>empty</strong> (<em>bool</em>) – True if missing fields essential for processing.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.shp2dex._shp2dex">
<code class="sig-prename descclassname">mxtoolbox.process.shp2dex.</code><code class="sig-name descname">_shp2dex</code><span class="sig-paren">(</span><em class="sig-param">sname</em>, <em class="sig-param">gname</em>, <em class="sig-param">lwest=True</em>, <em class="sig-param">skipland=True</em>, <em class="sig-param">fill_dataframe=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.shp2dex._shp2dex" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract egg code data from CIS ESRI shapefiles.</p>
<p>Conversion from map coordinates to decimal degrees
is carried out by the cartopy library. Point in polygon
querying is done using the matplotlib library.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sname</strong> (<em>string</em>) – The shapefile (.shp) path and name.</p></li>
<li><p><strong>gname</strong> (<em>string</em>) – Path and name of the text file containing
the queried coordinates. This is expected to be
a two column file containing [lon lat] points
separated by spaces.</p></li>
<li><p><strong>lwest</strong> (<em>bool</em>) – Return longitude as negative west, defaults
to True.</p></li>
<li><p><strong>skipland</strong> (<em>bool</em>) – Skip polygons marked as land if this is True.
Defaults to True. Skipping land will be faster.
If it is not known if the grid has points
on land and you wish to mark land points, set
to false.</p></li>
<li><p><strong>fill_dataframe</strong> (<em>bool</em>) – If False return an empty dataframe but a full
printable string column. False reduces computation
time by half and is the default when this module
is called from command line.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A dataframe with columns,</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Longitude (west)</p></li>
<li><p>Latitude</p></li>
<li><p>Legend</p></li>
<li><p>Total ice concentration</p></li>
<li><p>Partial ice concentration (thickest ice)</p></li>
<li><p>Stage of developpment (thickest ice)</p></li>
<li><p>Form of ice (thickest ice)</p></li>
<li><p>Partial ice concentration (second thickest ice)</p></li>
<li><p>Stage of developpment (second thickest ice)</p></li>
<li><p>Form of ice (second thickest ice)</p></li>
<li><p>Partial ice concentration (third thickest ice)</p></li>
<li><p>Stage of developpment (third thickest ice)</p></li>
<li><p>Form of ice (third thickest ice)</p></li>
<li><p>Printable dex strings</p></li>
</ol>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.Dataframe</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">math_.in_polygon()</span></code></dt><dd><p>Point in polygon querying.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.shp2dex._parse_prj">
<code class="sig-prename descclassname">mxtoolbox.process.shp2dex.</code><code class="sig-name descname">_parse_prj</code><span class="sig-paren">(</span><em class="sig-param">fname</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.shp2dex._parse_prj" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse shapefile (.prj) for projection parameters.</p>
<p>Geographical projection information for shapefile data is
contained in a companion file with the extension <cite>.prj</cite>. The
Basemap class instance needs this information to convert
polygon coordinates from map units (m) to longitudes and
latitudes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fname</strong> (<em>str</em>) – Name of the projection file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>proj</strong> (<em>str</em>) – Projection name abbreviated for input to Basemap.</p></li>
<li><p><strong>lat0</strong> (<em>float</em>) – Latitude of origin.</p></li>
<li><p><strong>lon0</strong> (<em>float</em>) – Longitude of origin.</p></li>
<li><p><strong>std1</strong> (<em>float</em>) – Standard parallel 1 used by LCC projection.</p></li>
<li><p><strong>std2</strong> (<em>float</em>) – Standard parallel 2 used by LCC projection.</p></li>
<li><p><strong>a</strong> (<em>float</em>) – Datum semi-major radius.</p></li>
<li><p><strong>ifp</strong> (<em>float</em>) – Inverse flattening parameter. Used to obtain the Datum
semi-minor radius.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the moment, only Lambert conformal conic projections
are supported.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.shp2dex._manage_shapefile_types">
<code class="sig-prename descclassname">mxtoolbox.process.shp2dex.</code><code class="sig-name descname">_manage_shapefile_types</code><span class="sig-paren">(</span><em class="sig-param">dataframe</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.shp2dex._manage_shapefile_types" title="Permalink to this definition">¶</a></dt>
<dd><p>Funnel shapefiles types to uniform labels.</p>
<p>Labels of the information inside CIS shapefiles
that this module processes have changed several times
in the past. To avoid cluttered error handling in the
main code from future new shapefile types, all files
are converted to type Z before processing. Important
label differences between types are summarized below.</p>
<p>Shapefile types</p>
<blockquote>
<div><ul>
<li><p>Type A:</p>
<blockquote>
<div><div class="line-block">
<div class="line">Legend string = A_LEGEND</div>
<div class="line">Legend strings = [‘Bergy water’, ‘Egg’, ‘Fast ice’, ‘Ice free’, ‘Land’, ‘Open water’, ‘Remote egg’]</div>
<div class="line">Old egg code = [E_CT, E_CA, … ]</div>
<div class="line">Area string = AREA</div>
<div class="line">Missing concentration = [‘’]</div>
<div class="line">Missing form = [‘’, ‘X’]</div>
<div class="line">Missing stage = [‘’]</div>
<div class="line">Example = “GEC_H_19740102.shp”</div>
</div>
</div></blockquote>
</li>
<li><p>Type B:</p>
<blockquote>
<div><div class="line-block">
<div class="line">Legend string = POLY_TYPE</div>
<div class="line">Legend strings = [‘I’, ‘L’, ‘N’, ‘W’]</div>
<div class="line">New egg code = [CT, CA, … ]</div>
<div class="line">Area string = AREA</div>
<div class="line">Missing concentration = [‘’, ‘-9’, ‘99’]</div>
<div class="line">Missing form = [‘’, ‘-9’, ‘99’]</div>
<div class="line">Missing stage = [‘’, ‘-9’, ‘99’]</div>
<div class="line">Example = “GEC_D_20150108.shp”</div>
</div>
</div></blockquote>
</li>
<li><p>Type C:</p>
<blockquote>
<div><div class="line-block">
<div class="line">Legend string = SGD_POLY_T</div>
<div class="line">Legend strings = [‘I’, ‘L’, ‘W’]</div>
<div class="line">New egg code = [SGD_CT, SGD_CA, … ]</div>
<div class="line">Old egg code = [E_CT, E_CA, … ]</div>
<div class="line">Area string = AREA</div>
<div class="line">Missing concentration = [‘’]</div>
<div class="line">Missing form = [‘’, ‘X’]</div>
<div class="line">Missing stage = [‘’]</div>
<div class="line">Example = “GEC_H_20200120.shp”</div>
</div>
</div></blockquote>
</li>
<li><p>Type D:</p>
<blockquote>
<div><div class="line-block">
<div class="line">Legend string = POLY_TYPE</div>
<div class="line">Legend strings = [‘I’, ‘L’, ‘W’]</div>
<div class="line">New egg code = [CT, CA, … ]</div>
<div class="line">Old egg code = [E_CT, E_CA, … ]</div>
<div class="line">Area string = AREA</div>
<div class="line">Missing concentration = [‘’]</div>
<div class="line">Missing form = [‘’, ‘X’]</div>
<div class="line">Missing stage = [‘’]</div>
<div class="line">Example = “GEC_H_20200309.shp”</div>
</div>
</div></blockquote>
</li>
<li><p>Type Z:</p>
<blockquote>
<div><div class="line-block">
<div class="line">Legend string = LEGEND</div>
<div class="line">Legend strings = [‘I’, ‘F’, ‘L’, ‘W’, ‘N’]</div>
<div class="line">Old egg code = [E_CT, E_CA, … ]</div>
<div class="line">Area string = AREA</div>
<div class="line">Missing concentration = [‘X’]</div>
<div class="line">Missing form = [‘X’]</div>
<div class="line">Missing stage = [‘X’]</div>
<div class="line">Example = None</div>
</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataframe</strong> (<em>pandas.DataFrame</em>) – Output from load_cis_shp of type A, B, C or D.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dataframe</strong> – Type Z.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.shp2dex._newegg_2_oldegg">
<code class="sig-prename descclassname">mxtoolbox.process.shp2dex.</code><code class="sig-name descname">_newegg_2_oldegg</code><span class="sig-paren">(</span><em class="sig-param">egg_dict</em>, <em class="sig-param">sname</em>, <em class="sig-param">i</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.shp2dex._newegg_2_oldegg" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert new more precise egg code to older more general values.</p>
<p>Two different systems of egg code values exist in the CIS files. The
most recent offers the possibility of increased precision but is
this precision is rarely used. As it makes little difference for now
and as the next processing step expects values in the old format,
new format egg code is translated back via this routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>egg_dict</strong> (<em>dict</em>) – New egg code keys and values.</p></li>
<li><p><strong>sname</strong> (<em>str</em>) – Shapefile name.</p></li>
<li><p><strong>jj</strong> (<em>int</em>) – Polygon index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>translated</strong> – Input translated to old egg code.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.shp2dex._separate_wrapping_polygons">
<code class="sig-prename descclassname">mxtoolbox.process.shp2dex.</code><code class="sig-name descname">_separate_wrapping_polygons</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">decimals=5</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.shp2dex._separate_wrapping_polygons" title="Permalink to this definition">¶</a></dt>
<dd><p>Find wrapping points of polygon sequence stored in vectors <cite>x</cite> and <cite>y</cite>.</p>
<p>The CIS shapefiles contain complex polygons with ‘holes’, which are often other
polygons of the data set. The encompassing polygon is the first to be defined in
vectors <cite>x</cite> and <cite>y</cite>, and it ‘wraps’ to its first coordinate before the start of
the smaller polygon. This routine separates the these polygons by finding the
wrapping points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x, y</strong> (<em>1D array</em>) – Coordinates of the polygon sequence.</p></li>
<li><p><strong>decimals</strong> (<em>int</em>) – Number of decimals to keep in float comparison.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>polygons_x, polygons_y</strong> (<em>list of 1D arrays</em>) – Coordinates of the separated polygons.</p></li>
<li><p><strong>wrap_index</strong> (<em>1D int array</em>) – Index value of the wrapping points.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.shp2dex._show_cis_field">
<code class="sig-prename descclassname">mxtoolbox.process.shp2dex.</code><code class="sig-name descname">_show_cis_field</code><span class="sig-paren">(</span><em class="sig-param">fname</em>, <em class="sig-param">field</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.shp2dex._show_cis_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Print possible values of shapefile field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>str</em>) – Shapefile path and name (.shp).</p></li>
<li><p><strong>field</strong> (<em>str</em>) – Name of field to detail.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.shp2dex._show_cis_summary">
<code class="sig-prename descclassname">mxtoolbox.process.shp2dex.</code><code class="sig-name descname">_show_cis_summary</code><span class="sig-paren">(</span><em class="sig-param">fname</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.shp2dex._show_cis_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Print possible values of egg code data in shapefile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fname</strong> (<em>str</em>) – Shapefile path and name (.shp).</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.shp2dex.plot_cis_shp">
<code class="sig-prename descclassname">mxtoolbox.process.shp2dex.</code><code class="sig-name descname">plot_cis_shp</code><span class="sig-paren">(</span><em class="sig-param">sname</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.shp2dex.plot_cis_shp" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot polygons of a CIS ice shapefile.</p>
<p>Polygons are plotted from large to small. Color
meanings are,</p>
<blockquote>
<div><ul class="simple">
<li><p>Magenta: ice</p></li>
<li><p>Cyan: fast-ice</p></li>
<li><p>Grey: land</p></li>
<li><p>Blue: water</p></li>
<li><p>Black: no data</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sname</strong> (<em>str</em>) – Name and path of CIS shapefile.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-mxtoolbox.process.signal_">
<span id="signal-module"></span><h2>signal_ module<a class="headerlink" href="#module-mxtoolbox.process.signal_" title="Permalink to this headline">¶</a></h2>
<p>Analyses of 1D signal type datasets or multidimensional
arrays processed along one dimension. This includes
filtering and binning functions.</p>
<dl class="function">
<dt id="mxtoolbox.process.signal_.pd_bin">
<code class="sig-prename descclassname">mxtoolbox.process.signal_.</code><code class="sig-name descname">pd_bin</code><span class="sig-paren">(</span><em class="sig-param">dataframe</em>, <em class="sig-param">dim</em>, <em class="sig-param">binc</em>, <em class="sig-param">func=&lt;function nanmean&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.signal_.pd_bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin values in pandas dataframe.</p>
<p>Wrapper around xr_bin to allow bin averaging in pandas
dataframes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>pandas.Dataframe</em>) – Dataframe to operate on.</p></li>
<li><p><strong>dim</strong> (<em>str</em>) – Dimension to operate along</p></li>
<li><p><strong>binc</strong> (<em>array_like</em>) – Bin centers.</p></li>
<li><p><strong>func</strong> (<em>Object</em>) – Function used to reduce bin groups.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Input dataframe binned at <cite>binc</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.Dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.signal_.xr_bin">
<code class="sig-prename descclassname">mxtoolbox.process.signal_.</code><code class="sig-name descname">xr_bin</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">dim</em>, <em class="sig-param">binc</em>, <em class="sig-param">func=&lt;function nanmean&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.signal_.xr_bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin dataset along <cite>dim</cite>.</p>
<p>Convenience wrapper for the groupby_bins xarray method. Meant for
simply binning xarray <cite>dataset</cite> to the values of dimension <cite>dim</cite>, and
return values at bin centers <cite>binc</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>xarray.Dataset</em>) – Dataset to operate on.</p></li>
<li><p><strong>dim</strong> (<em>str</em>) – Name of dimension along which to bin.</p></li>
<li><p><strong>binc</strong> (<em>array_like</em>) – Bin centers.</p></li>
<li><p><strong>func</strong> (<em>Object</em>) – Function used to reduce bin groups.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataset binned at <cite>binc</cite> along <cite>dim</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.signal_.xr_filtfilt">
<code class="sig-prename descclassname">mxtoolbox.process.signal_.</code><code class="sig-name descname">xr_filtfilt</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">dim</em>, <em class="sig-param">cutoff</em>, <em class="sig-param">btype='low'</em>, <em class="sig-param">order=2</em>, <em class="sig-param">vars_=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.signal_.xr_filtfilt" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass xarray data through variable state forward-backward filter.</p>
<p>Data is first gridded to a regular time vector going from the
first element of <cite>dataset[dim]</cite> to its last element. The resolution
used is the median time step of the input time coordinate. Forward-
backward filtering doubles the window’s order, so the input value
is integer divided by two. Odd order values will result in filtering
of order <cite>int(order / 2)</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>xarray.Dataset</em>) – Input data.</p></li>
<li><p><strong>dim</strong> (<em>str</em>) – Dimension along which to filter.</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – Filter cutoff specified in Hz.</p></li>
<li><p><strong>btype</strong> (<em>str</em>) – Filter type passed to scipy.signal.butter.</p></li>
<li><p><strong>order</strong> (<em>int</em>) – Filter order passed to scipy.signal.butter.</p></li>
<li><p><strong>vars_</strong> (<em>list of str</em>) – Variables to filter, defaults to all.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The filtered input dataset</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.signal_.xr_godin">
<code class="sig-prename descclassname">mxtoolbox.process.signal_.</code><code class="sig-name descname">xr_godin</code><span class="sig-paren">(</span><em class="sig-param">dataarray</em>, <em class="sig-param">tname</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.signal_.xr_godin" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply Godin filter to <cite>dataarray</cite> along time dimension.</p>
<p>Godin filtering is meant to remove the semi-diurnal and
diurnal components of tide. It consists of iteratively
time averaging over 24, 24, and 25 hours, and then
downsampling to the daily scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataarray</strong> (<em>xarray.DataArray</em>) – DataArray on which to operate.</p></li>
<li><p><strong>tname</strong> (<em>str</em>) – Name of the time dimension.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Godin filtered DataArray.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mxtoolbox.process.signal_.xr_peaks">
<code class="sig-prename descclassname">mxtoolbox.process.signal_.</code><code class="sig-name descname">xr_peaks</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">th_array</em>, <em class="sig-param">tname</em>, <em class="sig-param">two_sided=True</em>, <em class="sig-param">fp_kwargs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mxtoolbox.process.signal_.xr_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Find peaks in xarray dataset.</p>
<p>!!!The UI here needs to be reworked and tested!!!</p>
<p>Wrapper of scipy.signal.find_peaks that takes as input the array in which
to find peaks, the variable threshold array ‘th_array’ and their matching
x coordinate name ‘tname’. If two_sided is True, positive and negative peaks
above the threshold will be returned.</p>
<p>out is a tuple formed of DataArrays for high peaks, low peaks (two_sided=True), and
index of peaks in original array.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">process subpackage</a><ul>
<li><a class="reference internal" href="#module-mxtoolbox.process.analyses">analyses module</a></li>
<li><a class="reference internal" href="#module-mxtoolbox.process.convert">convert module</a></li>
<li><a class="reference internal" href="#module-mxtoolbox.process.math_">math_ module</a></li>
<li><a class="reference internal" href="#module-mxtoolbox.process.shp2dex">shp2dex module</a></li>
<li><a class="reference internal" href="#module-mxtoolbox.process.signal_">signal_ module</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="mxtoolbox.plot.html"
                        title="previous chapter">plot subpackage</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="mxtoolbox.read.html"
                        title="next chapter">read subpackage</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/source/mxtoolbox.process.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mxtoolbox.read.html" title="read subpackage"
             >next</a> |</li>
        <li class="right" >
          <a href="mxtoolbox.plot.html" title="plot subpackage"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">mxtoolbox April 2020 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Jean-Luc Shaw.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.
    </div>
  </body>
</html>